checkout:
  post:
    - pwd
    - env
    - ls

dependencies:
  post:
    - docker-compose --version
    
    # update latest docker compose
    # MEMO set specific verstion
    # curl -L https://github.com/docker/compose/releases/download/1.14.0/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose
    - curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
    - sudo chmod +x /usr/local/bin/docker-compose
    - docker-compose --version

    # Updating from download.docker.com
    - curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
    - sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

database:
  override:
    - mysql -u ubuntu circle_test < ./sql/lihoubun.sql
    - sudo /etc/init.d/mysql stop

test:
  override:
    - pwd
    - ls
    - sudo apt-get update
    - sudo apt-get -y install docker-ce
    - docker-compose --version
    - curl -L https://github.com/docker/compose/releases/download/1.14.0/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose
    - sudo chmod +x /usr/local/bin/docker-compose
    - docker-compose --version
    
    - ./help.sh build
    - ./help.sh up
    - ./help.sh init
    - ./help.sh php --version
    - ./help.sh oil test --group=Api